(function(){"use strict";const e=window.Vue;function c(){return window.panel}const l=()=>window.panel.plugins.viewButtons!==void 0;function f(){return l()?new Proxy({},{get(){throw new Error("Vuex store is not available. Are you using Kirby 5? Use the `useContent` composable instead.")}}):c().app.$store}function h(){const t=c(),n=f(),s=l();if(s&&!("diff"in t.content))throw new Error("This plugin requires Kirby 5.0.0-rc.1 or higher. Please update your Kirby installation.");const i=o(s?()=>t.content.version("changes"):()=>n.getters["content/values"]()),u=o(s?()=>t.content.diff():()=>n.getters["content/changes"]()),d=o(s?()=>t.content.hasDiff():()=>n.getters["content/hasChanges"]()),r=s?t.content:new Proxy({},{get(){return()=>{}}});return{content:r,currentContent:i,contentChanges:u,hasChanges:d,update:async(a,v=!0)=>{if(!s&&a)for(const[y,S]of Object.entries(a))n.dispatch("content/update",[y,S]);const b=r.merge(a);v&&await r.save(b)}}}const o=e.computed;e.customRef,e.defineAsyncComponent,e.defineComponent,e.effectScope,e.getCurrentInstance,e.getCurrentScope,e.h,e.inject,e.isProxy,e.isReactive,e.isReadonly,e.isRef,e.isShallow,e.markRaw,e.nextTick,e.onActivated,e.onBeforeMount,e.onBeforeUnmount,e.onBeforeUpdate,e.onDeactivated,e.onErrorCaptured,e.onMounted,e.onRenderTracked,e.onRenderTriggered,e.onScopeDispose,e.onServerPrefetch,e.onUnmounted,e.onUpdated,e.provide,e.proxyRefs,e.reactive,e.readonly,e.ref,e.shallowReactive,e.shallowReadonly,e.shallowRef,e.toRaw,e.toRef,e.toRefs,e.triggerRef,e.unref,e.useAttrs,e.useCssModule,e.useCssVars,e.useListeners,e.useSlots,e.watch,e.watchEffect,e.watchPostEffect,e.watchSyncEffect;function p(t,n,s,i,u,d,r,w){var a=typeof t=="function"?t.options:t;return{exports:t,options:a}}var m=p({name:"k-tabs-field",extends:"k-tabs",inheritAttrs:!1,props:{value:String,tab:String},created:function(){this.$emit("input",this.getSavedTab())},mounted(){var t,n;(t=this.$el)==null||t.classList.add("k-field"),(n=this.$el)==null||n.classList.add("k-tabs-field")},watch:{value(){if(this.value==null||!this.tabs.find(t=>t.name===this.value)){let t=this.getSavedTab();t&&this.$emit("input",t);return}this.writeTabToLocalStorage(this.value),this.cancelChanges()}},computed:{current(){const t=this.tabs.find(n=>n.name===this.value)??this.tabs[0];return t==null?void 0:t.name},saveable(){return!1},buttons(){let t=this.visible.map(this.button),n=this;return t.map(function(s){return s.click=function(i){n.btnClick(s.name,i)},s})}},methods:{getSavedTab(){let t=this.getTabFromLocalStorage()??this.value;return((t?this.tabs.find(n=>n.name===t):null)??this.tabs[0]).name},cancelChanges(){if(!(!this.$attrs.name||this.$attrs.name==""))if(panel.view.props.originals){const t=c();t.view.props.originals[[this.$attrs.name]]=t.view.props.content[this.$attrs.name]}else{const t=h();t.content.version("latest")[this.$attrs.name]=t.content.version("changes")[this.$attrs.name]}},getTabFromLocalStorage(){try{return window.localStorage.getItem(`tabsfield-${this.$attrs.name}`)}catch{}return null},writeTabToLocalStorage(t){if(!this.$attrs.name||this.$attrs.name==""||t==null||t==null)return!1;try{return window.localStorage.setItem(`tabsfield-${this.$attrs.name}`,t),!0}catch{}return!1},btnClick(t,n){this.$emit("input",t)}}});const g=m.exports;panel.plugin("daandelange/tabsfield",{components:{},fields:{tabs:g}})})();
